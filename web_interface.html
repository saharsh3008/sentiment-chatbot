<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sentiment Analysis Chatbot</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        .animate-bounce {
            animation: bounce 1s infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const SentimentChatbot = () => {
            const [messages, setMessages] = useState([]);
            const [input, setInput] = useState('');
            const [isAnalyzing, setIsAnalyzing] = useState(false);
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            // Advanced sentiment analysis function
            const analyzeSentiment = (text) => {
                const lowerText = text.toLowerCase();
                
                const positiveWords = [
                    'good', 'great', 'excellent', 'amazing', 'wonderful', 'fantastic', 'love',
                    'happy', 'pleased', 'satisfied', 'perfect', 'awesome', 'brilliant', 'better',
                    'best', 'outstanding', 'superb', 'delighted', 'impressed', 'thank', 'thanks',
                    'appreciate', 'helpful', 'nice', 'glad', 'enjoy', 'enjoyed', 'beautiful',
                    'terrific', 'splendid', 'fabulous', 'remarkable', 'exceptional', 'positive',
                    'joyful', 'joy', 'smiling', 'smile', 'laughing', 'laugh', 'cheerful', 'cheer',
                    'excited', 'exciting', 'thrilled', 'thrilling', 'ecstatic', 'blissful', 'bliss',
                    'content', 'contented', 'pleasure', 'pleasant', 'fun', 'funny', 'hilarious',
                    'amusing', 'entertaining', 'relaxed', 'relaxing', 'peaceful', 'calm', 'serene',
                    'tranquil', 'comfortable', 'cozy', 'warm', 'loving', 'affectionate', 'caring',
                    'kind', 'generous', 'grateful', 'gratitude', 'blessed', 'fortunate', 'lucky',
                    'proud', 'accomplished', 'achieved', 'successful', 'victorious', 'triumphant',
                    'confident', 'optimistic', 'hopeful', 'encouraging', 'inspiring', 'motivated',
                    'enthusiastic', 'passionate', 'vibrant', 'energetic', 'lively', 'vital',
                    'radiant', 'glowing', 'sparkling', 'shining', 'brilliant', 'magnificent',
                    'spectacular', 'marvelous', 'super', 'incredible', 'unbelievable', 'phenomenal'
                ];
                
                const negativeWords = [
                    // Strong negative words
                    'kill', 'murder', 'death', 'die', 'dead', 'hate', 'hated', 'hating',
                    'destroy', 'destruction', 'ruin', 'ruined', 'damn', 'damned', 'hell',
                    'suck', 'sucks', 'sucked', 'fuck', 'fucking', 'shit', 'shitty',
                    'asshole', 'bastard', 'bitch', 'crap', 'craps', 'bullshit',

                    // Emotional negative words
                    'angry', 'rage', 'furious', 'enraged', 'infuriated', 'outraged',
                    'frustrated', 'frustrating', 'annoyed', 'annoying', 'irritated',
                    'irritating', 'upset', 'disturbed', 'distressed', 'worried',
                    'anxious', 'nervous', 'scared', 'afraid', 'terrified', 'frightened',
                    'horrified', 'shocked', 'disgusted', 'repulsed', 'revolted',

                    // Quality negative words
                    'bad', 'terrible', 'awful', 'horrible', 'atrocious', 'abominable',
                    'dreadful', 'vile', 'wretched', 'miserable', 'pathetic', 'pitiful',
                    'lousy', 'crappy', 'shoddy', 'inferior', 'substandard', 'defective',
                    'broken', 'damaged', 'ruined', 'spoiled', 'rotten', 'stale',

                    // Experience negative words
                    'disappointing', 'disappointed', 'disappointment', 'letdown',
                    'failed', 'failure', 'failing', 'unsuccessful', 'useless',
                    'worthless', 'pointless', 'meaningless', 'stupid', 'dumb',
                    'idiotic', 'ridiculous', 'absurd', 'nonsense', 'crazy',

                    // Problem negative words
                    'problem', 'problems', 'issue', 'issues', 'trouble', 'troubles',
                    'difficulty', 'difficulties', 'complication', 'complications',
                    'obstacle', 'obstacles', 'barrier', 'barriers', 'hurdle', 'hurdles',
                    'setback', 'setbacks', 'drawback', 'drawbacks', 'disadvantage',

                    // Complaint words
                    'complaint', 'complaints', 'unhappy', 'dissatisfied', 'unsatisfied',
                    'displeased', 'discontent', 'discontented', 'grievance', 'grievances',
                    'beef', 'gripe', 'griping', 'whining', 'complaining',

                    // Mild negative words
                    'poor', 'worst', 'worse', 'sad', 'sorrow', 'sorrowful', 'grief',
                    'grieving', 'mourn', 'mourning', 'depressed', 'depressing', 'gloomy',
                    'dreary', 'dismal', 'bleak', 'dark', 'negative', 'pessimistic',

                    // Additional negative words
                    'never', 'no', 'none', 'nothing', 'nobody', 'nowhere', 'rejected',
                    'rejection', 'denied', 'denial', 'refused', 'refusal', 'banned',
                    'ban', 'forbidden', 'prohibited', 'illegal', 'unlawful', 'wrong',
                    'mistake', 'error', 'fault', 'blame', 'guilt', 'guilty', 'ashamed',
                    'embarrassed', 'humiliated', 'insulted', 'offended', 'hurt',
                    'pain', 'painful', 'suffering', 'suffer', 'agony', 'torment',
                    'torture', 'cruel', 'cruelty', 'brutal', 'brutality', 'violent',
                    'violence', 'abuse', 'abused', 'victim', 'victimized', 'oppressed',
                    'oppression', 'injustice', 'unfair', 'unfairness', 'corrupt',
                    'corruption', 'scam', 'scammed', 'fraud', 'fraudulent', 'deceit',
                    'deceitful', 'lie', 'lied', 'lying', 'false', 'falsely', 'fake',
                    'phony', 'counterfeit', 'bogus', 'spurious'
                ];

                const intensifiers = ['very', 'extremely', 'really', 'absolutely', 'totally', 'completely'];
                const negations = ['not', 'no', 'never', 'neither', 'nobody', 'nothing', "n't", 'dont'];

                let score = 0;
                let positiveCount = 0;
                let negativeCount = 0;
                const words = lowerText.split(/\s+/);

                for (let i = 0; i < words.length; i++) {
                    const word = words[i].replace(/[^\w\s]|_/g, "");
                    const prevWord = i > 0 ? words[i - 1].replace(/[^\w\s]|_/g, "") : '';
                    const isNegated = negations.includes(prevWord);
                    const isIntensified = intensifiers.includes(prevWord);
                    const multiplier = isIntensified ? 1.5 : 1;

                    if (positiveWords.includes(word)) {
                        if (isNegated) {
                            score -= 1 * multiplier;
                            negativeCount++;
                        } else {
                            score += 1 * multiplier;
                            positiveCount++;
                        }
                    }

                    if (negativeWords.includes(word)) {
                        if (isNegated) {
                            score += 0.5 * multiplier;
                            positiveCount++;
                        } else {
                            score -= 1 * multiplier;
                            negativeCount++;
                        }
                    }
                }

                const totalWords = positiveCount + negativeCount;
                const normalizedScore = totalWords > 0 ? score / totalWords : 0;

                // Adjust thresholds based on word counts for better accuracy
                let positiveThreshold = 0.2;
                let negativeThreshold = -0.2;

                // If we have strong negative words, be more sensitive
                const strongNegativeWords = ['kill', 'murder', 'death', 'hate', 'fuck', 'shit', 'damn', 'hell'];
                const hasStrongNegative = words.some(word => strongNegativeWords.includes(word.replace(/[^\w\s]|_/g, "")));

                if (hasStrongNegative) {
                    negativeThreshold = -0.1; // More sensitive to strong negative words
                }

                // If message is short and contains negative words, classify as negative
                if (words.length <= 3 && negativeCount > 0 && positiveCount === 0) {
                    negativeThreshold = 0; // Even single negative words in short messages should be negative
                }

                let sentiment, confidence, emoji;
                if (normalizedScore > positiveThreshold) {
                    sentiment = 'Positive';
                    confidence = Math.min(95, 60 + normalizedScore * 50);
                    emoji = 'üòä';
                } else if (normalizedScore < negativeThreshold) {
                    sentiment = 'Negative';
                    confidence = Math.min(95, 60 + Math.abs(normalizedScore) * 50);
                    emoji = 'üòî';
                } else {
                    sentiment = 'Neutral';
                    confidence = Math.max(50, 70 - Math.abs(normalizedScore) * 50);
                    emoji = 'üòê';
                }

                return {
                    sentiment,
                    score: normalizedScore,
                    confidence: Math.round(confidence),
                    emoji,
                    positiveCount,
                    negativeCount
                };
            };

            const generateResponse = async (userMessage, sentiment) => {
                try {
                    const response = await fetch('http://localhost:5000/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ message: userMessage })
                    });

                    if (!response.ok) {
                        throw new Error('API request failed');
                    }

                    const data = await response.json();
                    return {
                        response: data.bot_response,
                        sentiment: data.sentiment
                    };
                } catch (error) {
                    console.error('API call failed:', error);
                    // Fallback to local responses if API is unavailable
                    const responses = {
                        Positive: [
                            "I'm glad to hear that! How else can I assist you today?",
                            "That's wonderful! Is there anything else you'd like to discuss?",
                            "Great to hear positive feedback! What else can I help with?",
                        ],
                        Negative: [
                            "I'm sorry to hear that. Let me help address your concerns.",
                            "I understand your frustration. How can I make this better for you?",
                            "Your feedback is important. Let me see how I can help resolve this.",
                        ],
                        Neutral: [
                            "I understand. How can I assist you further?",
                            "Thank you for sharing. What else would you like to know?",
                            "I'm here to help. What would you like to discuss?",
                        ]
                    };

                    const sentimentResponses = responses[sentiment] || responses.Neutral;
                    return {
                        response: sentimentResponses[Math.floor(Math.random() * sentimentResponses.length)],
                        sentiment: sentiment
                    };
                }
            };

            const calculateOverallSentiment = () => {
                const userMessages = messages.filter(m => m.role === 'user');
                if (userMessages.length === 0) return null;

                let totalScore = 0;
                let totalConfidence = 0;
                const sentimentCounts = { Positive: 0, Negative: 0, Neutral: 0 };
                const scoreHistory = [];

                userMessages.forEach(msg => {
                    totalScore += msg.sentimentData.score;
                    totalConfidence += msg.sentimentData.confidence;
                    sentimentCounts[msg.sentimentData.sentiment]++;
                    scoreHistory.push(msg.sentimentData.score);
                });

                const avgScore = totalScore / userMessages.length;
                const avgConfidence = Math.round(totalConfidence / userMessages.length);

                let trend = 'Stable';
                if (scoreHistory.length >= 3) {
                    const firstHalf = scoreHistory.slice(0, Math.floor(scoreHistory.length / 2));
                    const secondHalf = scoreHistory.slice(Math.floor(scoreHistory.length / 2));
                    const firstAvg = firstHalf.reduce((a, b) => a + b, 0) / firstHalf.length;
                    const secondAvg = secondHalf.reduce((a, b) => a + b, 0) / secondHalf.length;
                    
                    if (secondAvg - firstAvg > 0.2) trend = 'Improving';
                    else if (firstAvg - secondAvg > 0.2) trend = 'Declining';
                }

                let overallSentiment, emoji;
                if (avgScore > 0.2) {
                    overallSentiment = 'Positive';
                    emoji = 'üòä';
                } else if (avgScore < -0.2) {
                    overallSentiment = 'Negative';
                    emoji = 'üòî';
                } else {
                    overallSentiment = 'Neutral';
                    emoji = 'üòê';
                }

                return {
                    overallSentiment,
                    emoji,
                    avgScore,
                    avgConfidence,
                    sentimentCounts,
                    trend,
                    messageCount: userMessages.length,
                    scoreHistory
                };
            };

            const handleSend = async () => {
                if (!input.trim()) return;

                const userMessage = input.trim();
                setInput('');
                setIsAnalyzing(true);

                const sentimentData = analyzeSentiment(userMessage);

                const newUserMessage = {
                    role: 'user',
                    content: userMessage,
                    sentimentData,
                    timestamp: new Date().toLocaleTimeString()
                };

                try {
                    const result = await generateResponse(userMessage, sentimentData.sentiment);
                    const botResponse = result.response;

                    setMessages(prev => [
                        ...prev,
                        newUserMessage,
                        {
                            role: 'bot',
                            content: botResponse,
                            timestamp: new Date().toLocaleTimeString()
                        }
                    ]);
                } catch (error) {
                    console.error('Error getting response:', error);
                    // Fallback response
                    const fallbackResponses = {
                        Positive: ["I'm glad to hear that! How else can I assist you today?"],
                        Negative: ["I'm sorry to hear that. Let me help address your concerns."],
                        Neutral: ["I understand. How can I assist you further?"]
                    };
                    const fallbackResponse = fallbackResponses[sentimentData.sentiment] || fallbackResponses.Neutral;

                    setMessages(prev => [
                        ...prev,
                        newUserMessage,
                        {
                            role: 'bot',
                            content: fallbackResponse[0],
                            timestamp: new Date().toLocaleTimeString()
                        }
                    ]);
                }

                setIsAnalyzing(false);
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSend();
                }
            };

            const resetChat = () => {
                setMessages([]);
                setInput('');
            };

            const getSentimentColor = (sentiment) => {
                switch (sentiment) {
                    case 'Positive': return 'text-green-600 bg-green-50';
                    case 'Negative': return 'text-red-600 bg-red-50';
                    default: return 'text-gray-600 bg-gray-50';
                }
            };

            const analysis = calculateOverallSentiment();

            return (
                <div className="min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="bg-white rounded-2xl shadow-2xl overflow-hidden">
                            {/* Header */}
                            <div className="bg-gradient-to-r from-blue-600 to-indigo-600 p-6 text-white">
                                <div className="flex items-center justify-between">
                                    <div>
                                        <h1 className="text-3xl font-bold mb-2">Sentiment Analysis Chatbot</h1>
                                        <p className="text-blue-100">Real-time conversation analysis with emotional intelligence</p>
                                    </div>
                                    <button
                                        onClick={resetChat}
                                        className="bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition-colors"
                                    >
                                        üîÑ Reset
                                    </button>
                                </div>
                            </div>

                            <div className="grid md:grid-cols-3 gap-0">
                                {/* Chat Area */}
                                <div className="md:col-span-2 flex flex-col">
                                    {/* Messages */}
                                    <div className="flex-1 p-6 space-y-4 bg-gray-50">
                                        {messages.length === 0 && (
                                            <div className="text-center text-gray-500 mt-20">
                                                <div className="text-6xl mb-4">üìä</div>
                                                <p className="text-lg">Start a conversation to see sentiment analysis</p>
                                                <p className="text-sm mt-2">Try: "Your service is amazing!" or "I'm disappointed"</p>
                                            </div>
                                        )}

                                        {messages.map((msg, idx) => (
                                            <div key={idx} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
                                                <div className={`max-w-[80%] ${msg.role === 'user' ? 'text-right' : 'text-left'}`}>
                                                    <div
                                                        className={`inline-block px-4 py-3 rounded-2xl ${
                                                            msg.role === 'user'
                                                                ? 'bg-blue-600 text-white'
                                                                : 'bg-white text-gray-800 border border-gray-200'
                                                        }`}
                                                    >
                                                        <p className="whitespace-pre-wrap">{msg.content}</p>
                                                        <p className="text-xs mt-1 opacity-70">{msg.timestamp}</p>
                                                    </div>
                                                    
                                                    {msg.role === 'user' && msg.sentimentData && (
                                                        <div className={`inline-block mt-2 px-3 py-1 rounded-full text-xs font-semibold ${getSentimentColor(msg.sentimentData.sentiment)}`}>
                                                            {msg.sentimentData.emoji} {msg.sentimentData.sentiment} ({msg.sentimentData.confidence}%)
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        ))}
                                        
                                        {isAnalyzing && (
                                            <div className="flex justify-start">
                                                <div className="bg-white text-gray-800 border border-gray-200 px-4 py-3 rounded-2xl">
                                                    <div className="flex gap-1">
                                                        <span className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0ms' }}></span>
                                                        <span className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '150ms' }}></span>
                                                        <span className="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '300ms' }}></span>
                                                    </div>
                                                </div>
                                            </div>
                                        )}
                                        
                                        <div ref={messagesEndRef} />
                                    </div>

                                    {/* Input Area */}
                                    <div className="p-4 bg-white border-t border-gray-200">
                                        <div className="flex gap-2">
                                            <input
                                                type="text"
                                                value={input}
                                                onChange={(e) => setInput(e.target.value)}
                                                onKeyPress={handleKeyPress}
                                                placeholder="Type your message..."
                                                className="flex-1 px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            />
                                            <button
                                                onClick={handleSend}
                                                disabled={!input.trim() || isAnalyzing}
                                                className="px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors"
                                            >
                                                Send
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                {/* Analysis Panel */}
                                <div className="bg-gradient-to-br from-gray-50 to-gray-100 p-6 border-l border-gray-200">
                                    <h2 className="text-xl font-bold text-gray-800 mb-4">üìä Live Analysis</h2>

                                    {analysis ? (
                                        <div className="space-y-4">
                                            {/* Overall Sentiment */}
                                            <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-200">
                                                <h3 className="text-sm font-semibold text-gray-600 mb-2">Overall Sentiment</h3>
                                                <div className="flex items-center gap-3">
                                                    <span className="text-4xl">{analysis.emoji}</span>
                                                    <div>
                                                        <p className={`text-2xl font-bold ${
                                                            analysis.overallSentiment === 'Positive' ? 'text-green-600' :
                                                            analysis.overallSentiment === 'Negative' ? 'text-red-600' :
                                                            'text-gray-600'
                                                        }`}>
                                                            {analysis.overallSentiment}
                                                        </p>
                                                        <p className="text-sm text-gray-500">Confidence: {analysis.avgConfidence}%</p>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Trend */}
                                            <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-200">
                                                <h3 className="text-sm font-semibold text-gray-600 mb-2">Mood Trend</h3>
                                                <div className="flex items-center gap-2">
                                                    {analysis.trend === 'Improving' && (
                                                        <>
                                                            <span className="text-2xl">üìà</span>
                                                            <span className="text-green-600 font-semibold">Improving</span>
                                                        </>
                                                    )}
                                                    {analysis.trend === 'Declining' && (
                                                        <>
                                                            <span className="text-2xl">üìâ</span>
                                                            <span className="text-red-600 font-semibold">Declining</span>
                                                        </>
                                                    )}
                                                    {analysis.trend === 'Stable' && (
                                                        <>
                                                            <span className="text-2xl">‚û°Ô∏è</span>
                                                            <span className="text-gray-600 font-semibold">Stable</span>
                                                        </>
                                                    )}
                                                </div>
                                            </div>

                                            {/* Breakdown */}
                                            <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-200">
                                                <h3 className="text-sm font-semibold text-gray-600 mb-3">Sentiment Breakdown</h3>
                                                <div className="space-y-2">
                                                    <div className="flex items-center justify-between">
                                                        <span className="text-green-600 font-medium">üòä Positive</span>
                                                        <span className="text-gray-700 font-bold">{analysis.sentimentCounts.Positive}</span>
                                                    </div>
                                                    <div className="flex items-center justify-between">
                                                        <span className="text-gray-600 font-medium">üòê Neutral</span>
                                                        <span className="text-gray-700 font-bold">{analysis.sentimentCounts.Neutral}</span>
                                                    </div>
                                                    <div className="flex items-center justify-between">
                                                        <span className="text-red-600 font-medium">üòî Negative</span>
                                                        <span className="text-gray-700 font-bold">{analysis.sentimentCounts.Negative}</span>
                                                    </div>
                                                </div>
                                            </div>

                                            {/* Score History */}
                                            <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-200">
                                                <h3 className="text-sm font-semibold text-gray-600 mb-3">Score Timeline</h3>
                                                <div className="flex items-end gap-1 h-40 bg-gray-50 rounded p-3 border overflow-x-auto">
                                                    {analysis.scoreHistory.length > 0 ? analysis.scoreHistory.map((score, idx) => {
                                                        // Enhanced scaling for better visibility: base 20% + score contribution * 60, minimum 30%
                                                        const baseHeight = 20;
                                                        const scoreHeight = Math.abs(score) * 60;
                                                        const height = Math.max(baseHeight + scoreHeight, 30);

                                                        // Clear color logic with distinct colors
                                                        let barColor = 'bg-blue-500 hover:bg-blue-600'; // neutral default (blue)
                                                        let sentimentLabel = 'Neutral';
                                                        if (score > 0.15) {
                                                            barColor = 'bg-green-500 hover:bg-green-600'; // positive
                                                            sentimentLabel = 'Positive';
                                                        } else if (score < -0.15) {
                                                            barColor = 'bg-red-500 hover:bg-red-600'; // negative
                                                            sentimentLabel = 'Negative';
                                                        }

                                                        return (
                                                            <div
                                                                key={`score-${idx}-${score}-${Date.now()}`}
                                                                className="flex-1 flex flex-col justify-end min-w-[30px] max-w-[45px]"
                                                                title={`Message ${idx + 1}: ${score.toFixed(3)} (${sentimentLabel})`}
                                                            >
                                                                <div
                                                                    className={`w-full rounded-t transition-all duration-700 border-2 border-white shadow-md ${barColor} animate-pulse`}
                                                                    style={{ height: `${height}%`, animationDuration: '0.5s' }}
                                                                ></div>
                                                                <div className="text-xs text-center mt-1 text-gray-600 font-mono">
                                                                    {score.toFixed(1)}
                                                                </div>
                                                            </div>
                                                        );
                                                    }) : (
                                                        <div className="w-full text-center text-gray-400 text-sm py-8">
                                                            <div className="text-2xl mb-2">üìà</div>
                                                            Send messages to see sentiment timeline
                                                        </div>
                                                    )}
                                                </div>
                                                {analysis.scoreHistory.length > 0 && (
                                                    <div className="mt-3 text-xs text-gray-500 text-center space-y-1">
                                                        <div>üíö Positive ‚Ä¢ ‚ù§Ô∏è Negative ‚Ä¢ üíô Neutral ‚Ä¢ Hover bars for details</div>
                                                        <div className="text-xs text-gray-400">
                                                            Messages: {analysis.scoreHistory.length} |
                                                            Range: {Math.min(...analysis.scoreHistory).toFixed(2)} to {Math.max(...analysis.scoreHistory).toFixed(2)} |
                                                            Latest: {analysis.scoreHistory[analysis.scoreHistory.length - 1]?.toFixed(2)}
                                                        </div>
                                                    </div>
                                                )}
                                            </div>

                                            {/* Stats */}
                                            <div className="bg-white rounded-xl p-4 shadow-sm border border-gray-200">
                                                <h3 className="text-sm font-semibold text-gray-600 mb-2">Statistics</h3>
                                                <div className="space-y-1 text-sm text-gray-700">
                                                    <p>Total Messages: <span className="font-bold">{analysis.messageCount}</span></p>
                                                    <p>Avg Score: <span className="font-bold">{analysis.avgScore.toFixed(2)}</span></p>
                                                </div>
                                            </div>
                                        </div>
                                    ) : (
                                        <div className="text-center text-gray-500 mt-20">
                                            <p>Start chatting to see analysis</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>


                    </div>
                </div>
            );
        };

        ReactDOM.render(<SentimentChatbot />, document.getElementById('root'));
    </script>
</body>
</html>